# ğŸš€ é˜¿é‡Œäº‘æœåŠ¡å™¨éƒ¨ç½²æ¨èæŒ‡å—

> **ç‰ˆæœ¬**: 2025-01-29  
> **é€‚ç”¨é¡¹ç›®**: TradingAgents-CN è‚¡ç¥¨åˆ†æç³»ç»Ÿ  
> **éƒ¨ç½²æ–¹å¼**: Docker Compose

## ğŸ“Š é¡¹ç›®èµ„æºéœ€æ±‚åˆ†æ

### æŠ€æœ¯æ ˆ
- **Webæ¡†æ¶**: Streamlit (Python 3.10+)
- **æ•°æ®åº“**: MongoDB 4.4, Redis
- **å®¹å™¨**: Docker + Docker Compose
- **ä¾èµ–**: å¤§é‡PythonåŒ…ï¼ˆLangChain, PyTorch, Pandasç­‰ï¼‰

### èµ„æºå ç”¨é¢„ä¼°
| æœåŠ¡ | å†…å­˜å ç”¨ | CPUå ç”¨ | ç£ç›˜å ç”¨ |
|------|---------|---------|---------|
| Streamlit Web | 2-4GB | 2æ ¸å¿ƒ | 5GB |
| MongoDB | 1-2GB | 1æ ¸å¿ƒ | 10GB+ |
| Redis | 200-500MB | 0.5æ ¸å¿ƒ | 1GB |
| Dockerç³»ç»Ÿ | 500MB | 0.5æ ¸å¿ƒ | 5GB |
| **æ€»è®¡ï¼ˆæ¨èï¼‰** | **8-12GB** | **4æ ¸å¿ƒ** | **25-30GB** |

---

## ğŸ¯ æ¨èæ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆ1: è½»é‡åº”ç”¨æœåŠ¡å™¨ï¼ˆæ¨è â­ï¼‰

**é€‚åˆåœºæ™¯**: ä¸ªäººä½¿ç”¨ã€å°å›¢é˜Ÿã€é¢„ç®—æœ‰é™

#### æ¨èé…ç½®

| é…ç½®é¡¹ | è§„æ ¼ | ä»·æ ¼ï¼ˆçº¦ï¼‰ |
|--------|------|-----------|
| **å®ä¾‹ç±»å‹** | è½»é‡åº”ç”¨æœåŠ¡å™¨ | - |
| **CPU** | 4æ ¸ | - |
| **å†…å­˜** | 8GB | ï¿¥200-300/æœˆ |
| **ç³»ç»Ÿç›˜** | 40GB SSD | åŒ…å« |
| **æ•°æ®ç›˜** | 20GB SSDï¼ˆå¯é€‰ï¼‰ | ï¿¥10-20/æœˆ |
| **å¸¦å®½** | 3-5Mbps | åŒ…å« |
| **æµé‡åŒ…** | 500GB/æœˆ | åŒ…å« |
| **é•œåƒ** | Ubuntu 22.04 LTS | - |

#### ä¼˜åŠ¿
âœ… **æˆæœ¬ä½**: æ¯æœˆçº¦200-300å…ƒ  
âœ… **å¼€ç®±å³ç”¨**: é¢„è£…Dockerï¼Œéƒ¨ç½²ç®€å•  
âœ… **å¸¦å®½å……è¶³**: 3-5Mbpsæ»¡è¶³Webè®¿é—®  
âœ… **ç®¡ç†ç®€å•**: é˜¿é‡Œäº‘æ§åˆ¶å°ç»Ÿä¸€ç®¡ç†  

#### ç¼ºç‚¹
âš ï¸ **æ€§èƒ½å—é™**: é€‚åˆä¸­å°è§„æ¨¡ä½¿ç”¨  
âš ï¸ **æ‰©å±•æ€§å·®**: å‡çº§éœ€è¦åœæœºè¿ç§»  

#### è´­ä¹°é“¾æ¥
- [é˜¿é‡Œäº‘è½»é‡åº”ç”¨æœåŠ¡å™¨](https://ecs.console.aliyun.com/home#/region/cn-hangzhou)
- é€‰æ‹©ã€Œè½»é‡åº”ç”¨æœåŠ¡å™¨ã€ â†’ ã€Œ4æ ¸8GBã€ â†’ ã€ŒUbuntu 22.04ã€

---

### æ–¹æ¡ˆ2: ECSäº‘æœåŠ¡å™¨ï¼ˆç”Ÿäº§æ¨è â­â­ï¼‰

**é€‚åˆåœºæ™¯**: æ­£å¼ç”Ÿäº§ç¯å¢ƒã€éœ€è¦æ‰©å±•æ€§ã€å›¢é˜Ÿä½¿ç”¨

#### æ¨èé…ç½®ï¼ˆé€šç”¨å‹ g6ï¼‰

| é…ç½®é¡¹ | è§„æ ¼ | ä»·æ ¼ï¼ˆçº¦ï¼‰ |
|--------|------|-----------|
| **å®ä¾‹ç±»å‹** | ecs.g6.xlarge | - |
| **CPU** | 4æ ¸ | - |
| **å†…å­˜** | 16GB | ï¿¥400-600/æœˆ |
| **ç³»ç»Ÿç›˜** | 40GB ESSDäº‘ç›˜ | åŒ…å« |
| **æ•°æ®ç›˜** | 40GB ESSDäº‘ç›˜ | ï¿¥30-50/æœˆ |
| **å¸¦å®½** | æŒ‰é‡ä»˜è´¹/å›ºå®šå¸¦å®½ | ï¿¥23/Mbps/æœˆ |
| **é•œåƒ** | Ubuntu 22.04 LTS | - |

#### ä¼˜åŠ¿
âœ… **æ€§èƒ½å¼º**: æ›´å¥½çš„CPUå’Œå†…å­˜æ€§èƒ½  
âœ… **å¯æ‰©å±•**: æ”¯æŒå¼¹æ€§æ‰©å®¹  
âœ… **é«˜å¯ç”¨**: æ”¯æŒå¿«ç…§ã€é•œåƒå¤‡ä»½  
âœ… **çµæ´»è®¡è´¹**: æ”¯æŒåŒ…å¹´åŒ…æœˆã€æŒ‰é‡ä»˜è´¹  

#### ç¼ºç‚¹
âš ï¸ **æˆæœ¬è¾ƒé«˜**: æ¯æœˆçº¦500-700å…ƒï¼ˆå«å¸¦å®½ï¼‰  
âš ï¸ **é…ç½®å¤æ‚**: éœ€è¦æ‰‹åŠ¨é…ç½®å®‰å…¨ç»„ç­‰  

#### æ¨èå®ä¾‹è§„æ ¼
```
å®ä¾‹è§„æ ¼: ecs.g6.xlarge
vCPU: 4æ ¸
å†…å­˜: 16GB
ç½‘ç»œ: å¢å¼ºå‹
```

---

### æ–¹æ¡ˆ3: ECSç»æµå‹ï¼ˆé¢„ç®—æœ‰é™ï¼‰

**é€‚åˆåœºæ™¯**: æµ‹è¯•ç¯å¢ƒã€ä¸ªäººå­¦ä¹ ã€ä½æµé‡ä½¿ç”¨

| é…ç½®é¡¹ | è§„æ ¼ | ä»·æ ¼ï¼ˆçº¦ï¼‰ |
|--------|------|-----------|
| **å®ä¾‹ç±»å‹** | ecs.t6-c2m2.large | - |
| **CPU** | 2æ ¸ï¼ˆçªå‘æ€§èƒ½ï¼‰ | - |
| **å†…å­˜** | 4GB | ï¿¥150-200/æœˆ |
| **ç³»ç»Ÿç›˜** | 40GB ESSDäº‘ç›˜ | åŒ…å« |
| **æ•°æ®ç›˜** | 20GB ESSDäº‘ç›˜ | ï¿¥15-25/æœˆ |
| **å¸¦å®½** | 1-2Mbps | ï¿¥20/Mbps/æœˆ |

âš ï¸ **æ³¨æ„**: çªå‘æ€§èƒ½å®ä¾‹æœ‰CPUç§¯åˆ†é™åˆ¶ï¼Œé•¿æœŸé«˜è´Ÿè½½å¯èƒ½é™é¢‘

---

## ğŸ”§ è¯¦ç»†é…ç½®å»ºè®®

### ç³»ç»Ÿè¦æ±‚

#### æœ€ä½é…ç½®ï¼ˆä¸æ¨èç”Ÿäº§ï¼‰
- **CPU**: 2æ ¸
- **å†…å­˜**: 4GB
- **å­˜å‚¨**: 40GB
- **å¸¦å®½**: 1Mbps
- **é€‚ç”¨**: ä»…æµ‹è¯•ä½¿ç”¨

#### æ¨èé…ç½®ï¼ˆè½»é‡åº”ç”¨æœåŠ¡å™¨ï¼‰
- **CPU**: 4æ ¸
- **å†…å­˜**: 8GB
- **å­˜å‚¨**: 60GBï¼ˆç³»ç»Ÿç›˜40GB + æ•°æ®ç›˜20GBï¼‰
- **å¸¦å®½**: 3-5Mbps
- **é€‚ç”¨**: ä¸ªäºº/å°å›¢é˜Ÿä½¿ç”¨

#### ç”Ÿäº§é…ç½®ï¼ˆECSäº‘æœåŠ¡å™¨ï¼‰
- **CPU**: 4-8æ ¸
- **å†…å­˜**: 16GB
- **å­˜å‚¨**: 80GBï¼ˆç³»ç»Ÿç›˜40GB + æ•°æ®ç›˜40GBï¼‰
- **å¸¦å®½**: 5-10Mbps
- **é€‚ç”¨**: æ­£å¼ç”Ÿäº§ç¯å¢ƒ

---

## ğŸ’° æˆæœ¬ä¼°ç®—ï¼ˆå¹´åº¦ï¼‰

### æ–¹æ¡ˆ1: è½»é‡åº”ç”¨æœåŠ¡å™¨
```
æœåŠ¡å™¨: 8GB 4æ ¸ Ã— 12æœˆ = ï¿¥2,400-3,600/å¹´
æ•°æ®ç›˜: 20GB Ã— 12æœˆ = ï¿¥120-240/å¹´
åŸŸåï¼ˆå¯é€‰ï¼‰: = ï¿¥50-100/å¹´
SSLè¯ä¹¦ï¼ˆå¯é€‰ï¼‰: Let's Encryptå…è´¹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡: ï¿¥2,500-3,900/å¹´
```

### æ–¹æ¡ˆ2: ECSäº‘æœåŠ¡å™¨
```
æœåŠ¡å™¨: 16GB 4æ ¸ Ã— 12æœˆ = ï¿¥4,800-7,200/å¹´
æ•°æ®ç›˜: 40GB Ã— 12æœˆ = ï¿¥360-600/å¹´
å¸¦å®½: 5Mbps Ã— 12æœˆ = ï¿¥1,380/å¹´
åŸŸåï¼ˆå¯é€‰ï¼‰: = ï¿¥50-100/å¹´
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡: ï¿¥6,600-9,300/å¹´
```

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤ï¼ˆè½»é‡åº”ç”¨æœåŠ¡å™¨ï¼‰

### 1. è´­ä¹°æœåŠ¡å™¨

1. è®¿é—® [é˜¿é‡Œäº‘æ§åˆ¶å°](https://ecs.console.aliyun.com/)
2. é€‰æ‹©ã€Œè½»é‡åº”ç”¨æœåŠ¡å™¨ã€ â†’ ã€Œåˆ›å»ºã€
3. é€‰æ‹©é…ç½®ï¼š
   - **åœ°åŸŸ**: åä¸œ1ï¼ˆæ­å·ï¼‰æˆ–ååŒ—2ï¼ˆåŒ—äº¬ï¼‰
   - **é•œåƒ**: Ubuntu 22.04 LTS
   - **å¥—é¤**: 4æ ¸8GBï¼Œ40GB SSDï¼Œ3Mbps
   - **è´­ä¹°æ—¶é•¿**: å»ºè®®1å¹´ï¼ˆæœ‰æŠ˜æ‰£ï¼‰
4. è®¾ç½®rootå¯†ç æˆ–SSHå¯†é’¥

### 2. åˆå§‹åŒ–æœåŠ¡å™¨

```bash
# SSHè¿æ¥åˆ°æœåŠ¡å™¨
ssh root@your-server-ip

# æ›´æ–°ç³»ç»Ÿ
apt update && apt upgrade -y

# å®‰è£…Dockerï¼ˆå¦‚æœæœªé¢„è£…ï¼‰
curl -fsSL https://get.docker.com | bash

# å®‰è£…Docker Compose
curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose

# éªŒè¯å®‰è£…
docker --version
docker-compose --version
```

### 3. é…ç½®å®‰å…¨ç»„ï¼ˆé˜²ç«å¢™ï¼‰

åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°é…ç½®ï¼š

| ç«¯å£ | åè®® | è¯´æ˜ | æ¥æº |
|------|------|------|------|
| 22 | TCP | SSH | 0.0.0.0/0ï¼ˆå»ºè®®é™åˆ¶ä¸ºä½ çš„IPï¼‰ |
| 8501 | TCP | Streamlit Web | 0.0.0.0/0 |
| 8081 | TCP | Redis Commanderï¼ˆå¯é€‰ï¼‰ | ä½ çš„IP |
| 8082 | TCP | Mongo Expressï¼ˆå¯é€‰ï¼‰ | ä½ çš„IP |

âš ï¸ **å®‰å…¨æç¤º**: ç”Ÿäº§ç¯å¢ƒå»ºè®®å°†8081ã€8082ä»…å¼€æ”¾ç»™ç®¡ç†å‘˜IP

### 4. éƒ¨ç½²é¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/wateryu2030/newhigh-zh.git
cd newhigh-zh

# åˆ›å»º.envæ–‡ä»¶
cp .env.example .env
nano .env  # ç¼–è¾‘APIå¯†é’¥

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f web
```

### 5. è®¿é—®åº”ç”¨

```
http://your-server-ip:8501
```

---

## ğŸ”’ å®‰å…¨åŠ å›ºå»ºè®®

### 1. ä¿®æ”¹é»˜è®¤å¯†ç 
```bash
# ä¿®æ”¹rootå¯†ç 
passwd root

# åˆ›å»ºä¸“ç”¨ç”¨æˆ·ï¼ˆæ¨èï¼‰
adduser tradingagents
usermod -aG sudo tradingagents
usermod -aG docker tradingagents
```

### 2. é…ç½®é˜²ç«å¢™ï¼ˆUFWï¼‰
```bash
# å®‰è£…UFW
apt install ufw -y

# å…è®¸SSH
ufw allow 22/tcp

# å…è®¸Streamlit
ufw allow 8501/tcp

# å¯ç”¨é˜²ç«å¢™
ufw enable
```

### 3. å®šæœŸå¤‡ä»½
```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
cat > /root/backup.sh << 'EOF'
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/root/backups"
mkdir -p $BACKUP_DIR

# å¤‡ä»½MongoDBæ•°æ®
docker exec tradingagents-mongodb mongodump --out /data/backup_$DATE
docker cp tradingagents-mongodb:/data/backup_$DATE $BACKUP_DIR/mongodb_$DATE

# å¤‡ä»½é¡¹ç›®ä»£ç å’Œ.env
tar -czf $BACKUP_DIR/project_$DATE.tar.gz /root/newhigh-zh/.env /root/newhigh-zh/web /root/newhigh-zh/tradingagents

# åˆ é™¤7å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -type d -mtime +7 -exec rm -rf {} \;
find $BACKUP_DIR -type f -mtime +7 -delete
EOF

chmod +x /root/backup.sh

# æ·»åŠ åˆ°crontabï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½ï¼‰
crontab -e
# æ·»åŠ : 0 2 * * * /root/backup.sh
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ä½¿ç”¨æ•°æ®ç›˜å­˜å‚¨æ•°æ®
```bash
# æŒ‚è½½æ•°æ®ç›˜åˆ° /data
mkdir -p /data
# åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°æ ¼å¼åŒ–å¹¶æŒ‚è½½æ•°æ®ç›˜

# ä¿®æ”¹docker-compose.ymlä½¿ç”¨æ•°æ®ç›˜
volumes:
  - /data/mongodb:/data/db
  - /data/redis:/data
  - /data/logs:/app/logs
```

### 2. é™åˆ¶å®¹å™¨èµ„æº
```yaml
# docker-compose.yml
services:
  web:
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 4G
        reservations:
          cpus: '1'
          memory: 2G
```

### 3. ä½¿ç”¨Nginxåå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰
```nginx
# /etc/nginx/sites-available/tradingagents
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:8501;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. å†…å­˜ä¸è¶³
```bash
# æŸ¥çœ‹å†…å­˜ä½¿ç”¨
free -h
docker stats

# è§£å†³æ–¹æ¡ˆï¼šå¢åŠ äº¤æ¢ç©ºé—´
fallocate -l 4G /swapfile
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile
echo '/swapfile none swap sw 0 0' >> /etc/fstab
```

#### 2. ç£ç›˜ç©ºé—´ä¸è¶³
```bash
# æ¸…ç†Docker
docker system prune -a --volumes

# æ¸…ç†æ—¥å¿—
find /root/newhigh-zh/logs -type f -mtime +7 -delete
```

#### 3. æœåŠ¡æ— æ³•è®¿é—®
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps
docker-compose logs web

# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep 8501

# æ£€æŸ¥é˜²ç«å¢™
ufw status
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **é˜¿é‡Œäº‘æ–‡æ¡£**: https://help.aliyun.com/product/25365.html
- **é¡¹ç›®Issues**: https://github.com/wateryu2030/newhigh-zh/issues
- **Dockeræ–‡æ¡£**: https://docs.docker.com/

---

## âœ… æ€»ç»“æ¨è

### ä¸ªäººä½¿ç”¨/æµ‹è¯•ç¯å¢ƒ
ğŸ‘‰ **è½»é‡åº”ç”¨æœåŠ¡å™¨ 4æ ¸8GB**  
- æˆæœ¬: ï¿¥200-300/æœˆ
- é…ç½®ç®€å•ï¼Œå¤Ÿç”¨

### ç”Ÿäº§ç¯å¢ƒ/å›¢é˜Ÿä½¿ç”¨
ğŸ‘‰ **ECSäº‘æœåŠ¡å™¨ ecs.g6.xlarge (4æ ¸16GB)**  
- æˆæœ¬: ï¿¥500-700/æœˆ
- æ€§èƒ½å¥½ï¼Œå¯æ‰©å±•

### é¢„ç®—ç´§å¼ 
ğŸ‘‰ **è½»é‡åº”ç”¨æœåŠ¡å™¨ 2æ ¸4GB**  
- æˆæœ¬: ï¿¥100-150/æœˆ
- ä»…é€‚åˆæµ‹è¯•ï¼Œä¸å»ºè®®ç”Ÿäº§ä½¿ç”¨

---

**æœ€åæ›´æ–°**: 2025-01-29  
**ä½œè€…**: AI Assistant  
**ç‰ˆæœ¬**: 1.0

